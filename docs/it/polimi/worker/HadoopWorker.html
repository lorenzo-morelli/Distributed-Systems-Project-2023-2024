<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) on Tue May 21 10:15:04 CEST 2024 -->
<title>HadoopWorker</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2024-05-21">
<meta name="description" content="declaration: package: it.polimi.worker, class: HadoopWorker">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li><a href="#field-summary">Field</a></li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">it.polimi.worker</a></div>
<h1 title="Class HadoopWorker" class="title">Class HadoopWorker</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance"><a href="../common/HadoopFileManager.html" title="class in it.polimi.common">it.polimi.common.HadoopFileManager</a>
<div class="inheritance">it.polimi.worker.HadoopWorker</div>
</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">HadoopWorker</span>
<span class="extends-implements">extends <a href="../common/HadoopFileManager.html" title="class in it.polimi.common">HadoopFileManager</a></span></div>
<div class="block">This class is responsible for reading and writing data from HDFS at worker-side.
 It also processes the data and executes the operators on the data.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="inherited-list">
<h3 id="fields-inherited-from-class-it.polimi.common.HadoopFileManager">Fields inherited from class&nbsp;it.polimi.common.<a href="../common/HadoopFileManager.html" title="class in it.polimi.common">HadoopFileManager</a></h3>
<code><a href="../common/HadoopFileManager.html#BUFFER_SIZE">BUFFER_SIZE</a>, <a href="../common/HadoopFileManager.html#fs">fs</a>, <a href="../common/HadoopFileManager.html#HDFS_URI">HDFS_URI</a>, <a href="../common/HadoopFileManager.html#logger">logger</a></code></div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(java.lang.String)" class="member-name-link">HadoopWorker</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;address)</code></div>
<div class="col-last even-row-color">
<div class="block">HadoopWorker class constructor</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#findKey(int,java.lang.String)" class="member-name-link">findKey</a><wbr>(int&nbsp;idx,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;programId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The findKey method finds the key from the file.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/StringBuilder.html" title="class or interface in java.lang" class="external-link">StringBuilder</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#processData(java.lang.String,java.util.List)" class="member-name-link">processData</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;combinedData,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../common/KeyValuePair.html" title="class in it.polimi.common">KeyValuePair</a>&gt;&nbsp;result)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The processData method processes the data and executes the operators on the data.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#processLine(java.lang.String,java.util.List)" class="member-name-link">processLine</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;line,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../common/KeyValuePair.html" title="class in it.polimi.common">KeyValuePair</a>&gt;&nbsp;result)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The processLine method processes the line of the data.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../common/KeyValuePair.html" title="class in it.polimi.common">KeyValuePair</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readAndComputeReduce(int,it.polimi.common.messages.ReduceOperation,it.polimi.worker.models.Operator,it.polimi.worker.WorkerHandler,it.polimi.worker.models.CheckpointInfo)" class="member-name-link">readAndComputeReduce</a><wbr>(int&nbsp;idx,
 <a href="../common/messages/ReduceOperation.html" title="class in it.polimi.common.messages">ReduceOperation</a>&nbsp;reduceMessage,
 <a href="models/Operator.html" title="interface in it.polimi.worker.models">Operator</a>&nbsp;reduce,
 <a href="WorkerHandler.html" title="class in it.polimi.worker">WorkerHandler</a>&nbsp;workerHandler,
 <a href="models/CheckpointInfo.html" title="class in it.polimi.worker.models">CheckpointInfo</a>&nbsp;checkpointInfo)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The readAndComputeReduce method reads and computes the reduce operation.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private <a href="models/Data.html" title="class in it.polimi.worker.models">Data</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readFile(org.apache.hadoop.fs.FSDataInputStream,int)" class="member-name-link">readFile</a><wbr>(org.apache.hadoop.fs.FSDataInputStream&nbsp;in,
 int&nbsp;numPart)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The readFile method reads the file from HDFS.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readInputFile(int,it.polimi.common.messages.NormalOperations,it.polimi.worker.WorkerHandler,java.util.List,int,java.lang.String,it.polimi.common.KeyValuePair)" class="member-name-link">readInputFile</a><wbr>(int&nbsp;i,
 <a href="../common/messages/NormalOperations.html" title="class in it.polimi.common.messages">NormalOperations</a>&nbsp;task,
 <a href="WorkerHandler.html" title="class in it.polimi.worker">WorkerHandler</a>&nbsp;workerHandler,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="models/Operator.html" title="interface in it.polimi.worker.models">Operator</a>&gt;&nbsp;operators,
 int&nbsp;count,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;remainingString,
 <a href="../common/KeyValuePair.html" title="class in it.polimi.common">KeyValuePair</a>&nbsp;value)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The readInputFile method reads the input file and processes the data.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#writeKeys(java.lang.String,java.lang.String,it.polimi.common.KeyValuePair)" class="member-name-link">writeKeys</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;programId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;identifier,
 <a href="../common/KeyValuePair.html" title="class in it.polimi.common">KeyValuePair</a>&nbsp;result)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The writeKeys method writes the keys to HDFS.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#writeKeys(java.lang.String,java.lang.String,java.util.List,boolean,boolean)" class="member-name-link">writeKeys</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;programId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;identifier,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../common/KeyValuePair.html" title="class in it.polimi.common">KeyValuePair</a>&gt;&nbsp;result,
 boolean&nbsp;changeKey,
 boolean&nbsp;reduce)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The writeKeys method writes the keys to HDFS.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#writeResult(java.util.List,java.lang.String)" class="member-name-link">writeResult</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../common/KeyValuePair.html" title="class in it.polimi.common">KeyValuePair</a>&gt;&nbsp;data,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;path)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The writeResult method writes the result to HDFS.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-it.polimi.common.HadoopFileManager">Methods inherited from class&nbsp;it.polimi.common.<a href="../common/HadoopFileManager.html" title="class in it.polimi.common">HadoopFileManager</a></h3>
<code><a href="../common/HadoopFileManager.html#closeFileSystem()">closeFileSystem</a>, <a href="../common/HadoopFileManager.html#initialize()">initialize</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(java.lang.String)">
<h3>HadoopWorker</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">HadoopWorker</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;address)</span>
             throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">HadoopWorker class constructor</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>address</code> - it is the address of the HDFS.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if it is not possible to connect to the HDFS.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="processData(java.lang.String,java.util.List)">
<h3>processData</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/StringBuilder.html" title="class or interface in java.lang" class="external-link">StringBuilder</a></span>&nbsp;<span class="element-name">processData</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;combinedData,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../common/KeyValuePair.html" title="class in it.polimi.common">KeyValuePair</a>&gt;&nbsp;result)</span>
                          throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">The processData method processes the data and executes the operators on the data.
 It splits the data into lines and processes each line.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>combinedData</code> - it is the data to be processed.</dd>
<dd><code>result</code> - it is the list of KeyValuePair where the data will be stored.</dd>
<dt>Returns:</dt>
<dd>the partial tuple.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if there is an error processing the data.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="readInputFile(int,it.polimi.common.messages.NormalOperations,it.polimi.worker.WorkerHandler,java.util.List,int,java.lang.String,it.polimi.common.KeyValuePair)">
<h3>readInputFile</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">readInputFile</span><wbr><span class="parameters">(int&nbsp;i,
 <a href="../common/messages/NormalOperations.html" title="class in it.polimi.common.messages">NormalOperations</a>&nbsp;task,
 <a href="WorkerHandler.html" title="class in it.polimi.worker">WorkerHandler</a>&nbsp;workerHandler,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="models/Operator.html" title="interface in it.polimi.worker.models">Operator</a>&gt;&nbsp;operators,
 int&nbsp;count,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;remainingString,
 <a href="../common/KeyValuePair.html" title="class in it.polimi.common">KeyValuePair</a>&nbsp;value)</span>
                   throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">The readInputFile method reads the input file and processes the data.
 It reads the data from the input file and processes it using the operators.
 It also calls the WorkerHandler to write the processed data to HDFS.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>i</code> - it is the index of the file.</dd>
<dd><code>task</code> - it is the NormalOperations object.</dd>
<dd><code>workerHandler</code> - it is the WorkerHandler object.</dd>
<dd><code>operators</code> - it is the list of operators.</dd>
<dd><code>count</code> - it is the partition count, used to identify the partition.</dd>
<dd><code>remainingString</code> - it is the remaining string read from the checkpoint, if any.</dd>
<dd><code>value</code> - it is the KeyValuePair object read from the checkpoint, if any.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if there is an error reading the input file.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="processLine(java.lang.String,java.util.List)">
<h3>processLine</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">processLine</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;line,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../common/KeyValuePair.html" title="class in it.polimi.common">KeyValuePair</a>&gt;&nbsp;result)</span>
                  throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">The processLine method processes the line of the data.
 It splits the line into key and value and stores it in the result list.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>line</code> - it is the line to be processed.</dd>
<dd><code>result</code> - it is the list of KeyValuePair where the data will be stored.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if there is an error processing the line.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="writeKeys(java.lang.String,java.lang.String,it.polimi.common.KeyValuePair)">
<h3>writeKeys</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">writeKeys</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;programId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;identifier,
 <a href="../common/KeyValuePair.html" title="class in it.polimi.common">KeyValuePair</a>&nbsp;result)</span>
               throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">The writeKeys method writes the keys to HDFS.
 It writes the keys to HDFS in the specified path.
 This method is called in the reduce phase, i.e., the second phase of the program.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>programId</code> - it is the id of the program.</dd>
<dd><code>identifier</code> - it is the identifier of the program.</dd>
<dd><code>result</code> - it is the KeyValuePair object to be written.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if there is an error writing the keys.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="writeKeys(java.lang.String,java.lang.String,java.util.List,boolean,boolean)">
<h3>writeKeys</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">writeKeys</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;programId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;identifier,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../common/KeyValuePair.html" title="class in it.polimi.common">KeyValuePair</a>&gt;&nbsp;result,
 boolean&nbsp;changeKey,
 boolean&nbsp;reduce)</span>
               throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">The writeKeys method writes the keys to HDFS.
 It writes the keys to HDFS in the specified path.
 This method is called in the first phase of the program.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>programId</code> - it is the id of the program.</dd>
<dd><code>identifier</code> - it is the identifier of the program.</dd>
<dd><code>result</code> - it is the list of KeyValuePair objects to be written.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if there is an error writing the keys.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="writeResult(java.util.List,java.lang.String)">
<h3>writeResult</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">writeResult</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../common/KeyValuePair.html" title="class in it.polimi.common">KeyValuePair</a>&gt;&nbsp;data,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;path)</span>
                  throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">The writeResult method writes the result to HDFS.
 It writes the result to HDFS in the specified path.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>data</code> - it is the list of KeyValuePair objects to be written.</dd>
<dd><code>path</code> - it is the path where the data will be written.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if there is an error writing the result.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="readAndComputeReduce(int,it.polimi.common.messages.ReduceOperation,it.polimi.worker.models.Operator,it.polimi.worker.WorkerHandler,it.polimi.worker.models.CheckpointInfo)">
<h3>readAndComputeReduce</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../common/KeyValuePair.html" title="class in it.polimi.common">KeyValuePair</a></span>&nbsp;<span class="element-name">readAndComputeReduce</span><wbr><span class="parameters">(int&nbsp;idx,
 <a href="../common/messages/ReduceOperation.html" title="class in it.polimi.common.messages">ReduceOperation</a>&nbsp;reduceMessage,
 <a href="models/Operator.html" title="interface in it.polimi.worker.models">Operator</a>&nbsp;reduce,
 <a href="WorkerHandler.html" title="class in it.polimi.worker">WorkerHandler</a>&nbsp;workerHandler,
 <a href="models/CheckpointInfo.html" title="class in it.polimi.worker.models">CheckpointInfo</a>&nbsp;checkpointInfo)</span>
                                  throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a>,
<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></span></div>
<div class="block">The readAndComputeReduce method reads and computes the reduce operation.
 It reads the data from HDFS and computes the reduce operation on the data.
 It returns the KeyValuePair object after the reduce operation is computed.
 It is called in the second phase of the program.
 It calls also the function to create the checkpoint.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>idx</code> - it is the index of the file.</dd>
<dd><code>reduceMessage</code> - it is the ReduceOperation object.</dd>
<dd><code>reduce</code> - it is the ReduceOperator object.</dd>
<dd><code>workerHandler</code> - it is the WorkerHandler object.</dd>
<dd><code>checkpointInfo</code> - it is the CheckpointInfo object.</dd>
<dt>Returns:</dt>
<dd>the KeyValuePair object.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if there is an error reading the data.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if the key file is invalid.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findKey(int,java.lang.String)">
<h3>findKey</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a></span>&nbsp;<span class="element-name">findKey</span><wbr><span class="parameters">(int&nbsp;idx,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;programId)</span>
                 throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">The findKey method finds the key from the file.
 It finds the key from the file using the index and the programId.
 It returns the key from the file.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>idx</code> - it is the index of the file.</dd>
<dd><code>programId</code> - it is the id of the program.</dd>
<dt>Returns:</dt>
<dd>the key from the file.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if there is an error finding the key.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="readFile(org.apache.hadoop.fs.FSDataInputStream,int)">
<h3>readFile</h3>
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type"><a href="models/Data.html" title="class in it.polimi.worker.models">Data</a></span>&nbsp;<span class="element-name">readFile</span><wbr><span class="parameters">(org.apache.hadoop.fs.FSDataInputStream&nbsp;in,
 int&nbsp;numPart)</span>
               throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">The readFile method reads the file from HDFS.
 It reads the file from HDFS and returns the data.
 It reads the data in chunks of BUFFER_SIZE.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>in</code> - it is the FSDataInputStream object.</dd>
<dd><code>numPart</code> - it is the partition number.</dd>
<dt>Returns:</dt>
<dd>the Data object.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - if there is an error reading the file.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
